---
title: Deploy execution layer
description: 'Deploy execution layer clients (Linea Besu, Geth, Erigon) for The Linea stack'
sidebar_position: 3
mainSource:
  url: 'https://github.com/Consensys/linea-monorepo'
image: /img/socialCards/deploy-execution-layer.jpg
---

import DocCardList from '@theme/DocCardList';

export const relatedDocs = [
  {type: 'link', href: '/stack/guides/deployment-guides/deploy-maru', label: 'Deploy Maru'},
  {type: 'link', href: '/stack/guides/operations-guides', label: 'Operations Guides'},
];

The execution layer executes transactions and maintains EVM state. You can choose from multiple
execution clients: Linea Besu (recommended for operators), Geth, or Erigon.

## Prerequisites

- Docker v24 or higher (recommended)
- Network connectivity to consensus layer (Maru)
- Engine API JWT secret for Maru communication
- Sufficient storage for chain data

:::tip

Docker is the recommended deployment method. It simplifies installation, updates, and management.
Only use binary distribution if Docker is not available in your environment.

:::

## Choose an execution client

### Linea Besu (recommended)

Linea Besu includes Linea-specific plugins enabling:

- `linea_estimateGas` RPC method
- Sequencer functionality
- Linea-specific transaction validation
- Full Linea feature support

Use Linea Besu if you need Linea-specific features or plan to run a sequencer.

### Geth

Standard Ethereum client, suitable for:

- Following the chain
- Basic RPC serving
- Archive node operation

Geth does not support Linea-specific features like `linea_estimateGas`.

### Erigon

Optimized for:

- Archive nodes
- Historical data access
- Reduced storage requirements

Erigon does not support Linea-specific features.

## Deploy Linea Besu

Docker is the recommended deployment method for Linea Besu. Use the official Linea Besu package
Docker image:

```bash
docker run -d \
  --name linea-besu \
  --platform linux/amd64 \
  -p 8545:8545 \
  -p 8546:8546 \
  -p 8550:8550 \
  -p 30303:30303 \
  -v /path/to/linea-besu.config.toml:/var/lib/besu/linea-besu.config.toml:ro \
  -v /path/to/log4j.xml:/var/lib/besu/log4j.xml:ro \
  -v /path/to/jwt:/var/lib/besu/jwt:ro \
  -v besu-data:/data \
  -e JAVA_OPTS=-Xmx2g \
  consensys/linea-besu-package:latest \
  --profile=advanced-mainnet \
  --p2p-host=YOUR_IP_ADDRESS
```

## Alternative: Binary distribution

If you cannot use Docker, you can use the binary distribution. This method requires manual
installation and updates:

1. Download the Linea Besu package.
   - Get the latest release from [GitHub releases](https://github.com/Consensys/linea-monorepo/releases)
   - Download `linea-besu-package-<version>.tar.gz`

2. Extract the package.
```bash
tar -xzvf linea-besu-package-<version>.tar.gz
cd linea-besu/besu
```

3. Start Besu.
```bash
bin/besu --profile=advanced-mainnet
```

## Profiles

Linea Besu supports profiles for different configurations:

- `basic-mainnet`: Basic node without Linea-specific features
- `advanced-mainnet`: Full Linea features including `linea_estimateGas`
- `basic-sepolia`: Basic node for Sepolia testnet
- `advanced-sepolia`: Full features for Sepolia testnet

Use `advanced-*` profiles for operator nodes requiring Linea-specific features.

## Configuration

### Basic configuration

Create `linea-besu.config.toml`:

```toml
# data
network="linea-mainnet"
data-path="/data"

# Sync mode and data layer implementation
sync-mode="SNAP"
data-storage-format="BONSAI"

# Min gas price
min-gas-price=1000000

max-peers=50

# Host allow list
host-allowlist=["*"]

# engine
engine-host-allowlist=["*"]
engine-rpc-port=8550
engine-jwt-disabled=false
engine-jwt-secret="/var/lib/besu/jwt"

# rpc
rpc-http-enabled=true
rpc-http-host="0.0.0.0"
rpc-http-port=8545
rpc-http-api=["ADMIN","DEBUG","NET","ETH","CLIQUE","MINER","WEB3","TRACE"]
rpc-http-cors-origins=["*"]
rpc-http-max-active-connections=20000

# ws
rpc-ws-enabled=true
rpc-ws-api=["ADMIN","DEBUG","NET","ETH","CLIQUE","MINER","WEB3","TRACE"]
rpc-ws-host="0.0.0.0"
rpc-ws-port=8546
rpc-ws-max-active-connections=200

# p2p
p2p-port=30303
fast-sync-min-peers=1
Xdns-enabled=true

# metrics
metrics-enabled=true
metrics-host="0.0.0.0"
metrics-port=9545
```

### Engine API configuration

Configure Engine API for Maru communication:

- Set `engine-rpc-port=8550`
- Provide JWT secret via `engine-jwt-secret`
- Set `engine-jwt-disabled=false` to enable JWT authentication

### P2P configuration

Configure P2P networking:

- Set `p2p-port=30303` (TCP and UDP)
- Set `--p2p-host` to your public IP address
- Configure static nodes for private networks

### Storage configuration

Plan storage based on node type:

- Full node: Moderate storage, grows with network activity
- Archive node: Very high storage requirements for complete history

Use `data-storage-format="BONSAI"` for efficient storage.

## Ports

Execution layer uses these ports:

- 8545: JSON-RPC HTTP
- 8546: JSON-RPC WebSocket
- 8550: Engine API (for Maru)
- 30303: P2P networking (TCP and UDP)
- 9545: Metrics endpoint

## Connect to Maru

Ensure execution layer can communicate with Maru:

1. Configure Engine API endpoint in Maru config.
2. Provide JWT secret to both Maru and execution layer.
3. Verify network connectivity between components.

## Verification

Verify execution layer deployment:

1. Check node is running.
```bash
docker logs linea-besu
```

2. Test RPC endpoint.
```bash
curl -X POST http://localhost:8545 \
  -H "Content-Type: application/json" \
  -d '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}'
```

3. Check metrics.
```bash
curl http://localhost:9545/metrics
```

4. Verify connection to Maru (check Maru logs for successful Engine API connection).

## Troubleshooting

### Cannot connect to Maru

- Verify Engine API JWT secret matches in both Maru and execution layer
- Check network connectivity between components
- Verify Engine API port (8550) is accessible

### High memory usage

- Adjust JVM options: `-e JAVA_OPTS=-Xmx2g` (increase for archive nodes)
- Monitor memory usage and adjust as needed

### Storage growth

- Use BONSAI storage format for efficiency
- Plan for storage growth based on network activity
- Consider archive node requirements if maintaining full history

## Related documentation

<DocCardList items={relatedDocs} />
