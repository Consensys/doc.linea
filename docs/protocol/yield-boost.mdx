---
title: Yield Boost
description: ETH fund flow and role permissions in the Linea Yield Boost staking system.
sidebar_position: 4
image: /img/socialCards/yield-boost.jpg
---

# Yield Boost - ETH fund flow

:::caution
Yield Boost is not yet live. This documentation describes the intended design.
:::

## Overview

Yield Boost earns staking rewards on ETH deposited into LineaRollup and distributes those rewards back to users on L2. This page maps where ETH flows and which roles control each movement.

## High-level architecture

LineaRollup deposits on Ethereum L1 are staked via Lido V3 stVaults to generate beacon chain rewards, which are reported to L2 for distribution.

**Key entities:**

- **YieldManager** - Core L1 contract that routes ETH between LineaRollup and external staking strategies, and calculates reportable yield after deducting obligations.
- **Dashboard** - Lido V3 utility contract that wraps the StakingVault with operator fee handling and convenience functions for deposits and LST minting.
- **StakingVault** - Lido V3 vault that holds ETH for beacon chain staking. The vault owner controls deposits and withdrawals; withdrawal credentials point to the vault.
- **Node Operator** - Runs beacon chain validators on behalf of Linea. Has sole authority over when and how much ETH to deposit from the StakingVault into validators.
- **Automation Service** - Off-chain service that executes routine yield operations: reporting, reserve rebalancing, and obligation settlement.
- **L2MessageService** - L2 contract that receives yield messages from L1 and releases corresponding L2 ETH into circulation.
- **L2YieldDistributor** - Distributes newly circulated L2 ETH (backed by L1 staking rewards) to eligible recipients.

### L1 ETH flow

```mermaid
flowchart TD
    User([User])
    LR[LineaRollup]
    YM[YieldManager]
    DB[Dashboard]
    SV[StakingVault]
    NO([Node Operator])
    BC{{Beacon Chain}}

    User -->|deposit ETH| LR
    LR -->|excess ETH| YM
    YM -->|fund| DB
    DB -->|fund| SV
    NO -.->|discretion over beacon chain deposits| SV
    SV -->|stake| BC
    BC -->|withdrawal| SV
    SV -->|withdraw| DB
    DB -->|withdraw ETH| LR
    LR -->|withdraw ETH| User

    classDef admin fill:#f8d7da,stroke:#721c24,stroke-width:1px,color:#721c24
    classDef permissionless fill:#cce5ff,stroke:#004085,stroke-width:1px,color:#004085

    class NO admin
    class User permissionless
```

### Yield reporting and L2 distribution

```mermaid
flowchart LR
    subgraph L2["L2"]
      direction TB
      L2MS[L2MessageService]
      L2YD[L2YieldDistributor]
    end
    Auto([Automation Service]) -.->|reportYield| YM[YieldManager]
    YM -.->|query yield + obligations| DB[Dashboard]
    DB -->|stETH borrow liability| Lido[Lido]
    DB -->|protocol fees| Lido
    DB -->|node operator fees| FeeRecipient([Node Op Fee Recipient])
    YM -.->|reportNativeYield| LR[LineaRollup]
    LR -.->|MessageSent| L2MS[L2MessageService]
    L2MS -->|distribute yield| L2YD[L2YieldDistributor]

    classDef l2 fill:#d4edda,stroke:#155724,stroke-width:1px,color:#155724
    classDef admin fill:#f8d7da,stroke:#721c24,stroke-width:1px,color:#721c24

    class L2MS,L2YD l2
    class FeeRecipient admin
```

**Legend**
- **Solid line** - actual fund movement (ETH/stETH transfer)
- **Dashed line** - function call or event (no funds move)
- **Red** - privileged operator
- **Blue** - permissionless
- **Green** - L2

## Roles and fund movement permissions

| Role | Held By | ETH Movement Authorized |
|------|---------|------------------------|
| `YIELD_PROVIDER_STAKING_ROLE` | Automation Service | LineaRollup → YieldManager → StakingVault |
| `YIELD_PROVIDER_UNSTAKER_ROLE` | Automation Service | Validators → StakingVault → YieldManager → LineaRollup |
| `YIELD_REPORTER_ROLE` | Automation Service | Settles obligations from StakingVault (LST liabilities, protocol fees, operator fees); emits synthetic yield message to L2 |
| `STAKING_PAUSE_CONTROLLER_ROLE` | Security Council | None (pauses/unpauses beacon deposits) |
| `OSSIFICATION_INITIATOR_ROLE` | Security Council | Initiates full withdrawal of all staked funds |
| `OSSIFICATION_PROCESSOR_ROLE` | Automation Service | Progressive withdrawal during ossification |
| `SET_YIELD_MANAGER_ROLE` | Security Council | None (configuration) |
| Permissionless | Anyone | `fund()` donations; `unstakePermissionless()` + `replenishWithdrawalReserve()` during deficit |

## Fund flow scenarios

### 1. Staking

Surplus ETH in LineaRollup (above minimum reserve) is routed to the StakingVault for beacon chain staking.

```mermaid
sequenceDiagram
    actor Auto as Automation Service
    participant LR as LineaRollup
    participant YM as YieldManager
    participant DB as Dashboard
    participant SV as StakingVault
    actor NO as Node Operator
    participant BC as Beacon Chain

    Auto->>LR: transferFundsForNativeYield()
    LR-->>YM: send ETH
    Auto->>YM: fundYieldProvider()
    YM-->>DB: fund()
    DB-->>SV: fund()
    Note over NO: Decides when/how much to deposit
    SV-->>BC: stake ETH
```

### 2. Yield reporting

The Automation Service triggers yield reporting. Before the net surplus is relayed to L2, the YieldManager settles outstanding obligations.

```mermaid
sequenceDiagram
    actor Auto as Automation Service
    participant YM as YieldManager
    participant DB as Dashboard
    participant Lido as Lido
    participant Fee as Fee Recipient
    participant LR as LineaRollup
    participant L2MS as L2MessageService
    participant L2YD as L2YieldDistributor

    Auto-->>YM: reportYield()
    YM-->>DB: query yield + obligations

    alt StakingVault funds available
        Note over DB: Settle obligations
        YM->>Lido: rebalanceVaultWithShares()<br/>(stETH borrow liability)
        YM->>Lido: settleLidoFees()<br/>(protocol fees)
        YM->>DB: disburseFee()<br/>(node operator fees)
        DB->>Fee: send node operator fees
    else Insufficient funds
        Note over DB: Skip settlement<br/>carry forward obligations
    end

    YM-->>LR: reportNativeYield()<br/>(net surplus after obligations)
    LR-->>L2MS: emit MessageSent (synthetic)
    L2MS->>L2YD: distribute yield
```

No L1 ETH moves for the yield report itself - obligation payments (solid arrows) are the only L1 ETH transfers. The `MessageSent` event is synthetic: it relays the net surplus to L2 for distribution without bridging ETH.

### 3. Reserve replenishment - operator

Two-phase process: first trigger beacon chain withdrawal, then route funds to LineaRollup once they arrive in the vault.

```mermaid
sequenceDiagram
    actor Auto as Automation Service
    participant LR as LineaRollup
    participant YM as YieldManager
    participant SV as StakingVault
    participant BC as Beacon Chain

    rect rgba(230, 240, 255, 0.6)
        Note over Auto: Phase 1 - Unstake
        Auto->>YM: unstake()
        YM-->>SV: triggerValidatorWithdrawals()
        SV-->>BC: request withdrawal
        Note over BC: Withdrawal delay
        BC->>SV: automatic withdrawal
    end

    rect rgba(240, 255, 230, 0.6)
        Note over Auto: Phase 2 - Replenish reserve
        Auto->>YM: safeAddToWithdrawalReserve()
        YM-->>SV: withdraw()
        SV-->>LR: send ETH
    end
```

### 4. Permissionless flows

When LineaRollup balance drops below the minimum reserve, anyone can trigger unstaking and reserve replenishment.

```mermaid
sequenceDiagram
    actor U as Anyone
    participant LR as LineaRollup
    participant YM as YieldManager
    participant SV as StakingVault
    participant BC as Beacon Chain
    Note over LR: Reserve in deficit

    rect rgba(230, 240, 255, 0.6)
        Note over LR: Phase 1 - Unstake
        U->>YM: unstakePermissionless()
        Note over YM: Validate request against <br/> EIP-4788 beacon root
        YM-->>SV: triggerValidatorWithdrawals()
        SV-->>BC: request withdrawal
        Note over BC: Withdrawal delay
        BC->>SV: automatic withdrawal
    end

    rect rgba(240, 255, 230, 0.6)
        Note over LR: Phase 2 - Replenish withdrawal reserve
        U->>YM: replenishWithdrawalReserve()
        YM-->>SV: withdraw()
        SV-->>LR: send ETH
    end
```

`unstakePermissionless()` is capped to the remaining deficit minus available liquidity in the YieldManager and provider. `replenishWithdrawalReserve()` is similarly capped to the current deficit.

### 5. LST withdrawal - last resort

If LineaRollup lacks ETH for a user withdrawal, stETH is minted against StakingVault collateral and sent directly to the user as a last resort.

```mermaid
sequenceDiagram
    actor U as User
    participant LR as LineaRollup
    participant YM as YieldManager
    participant DB as Dashboard

    Note over LR: Insufficient ETH for withdrawal
    U->>LR: claimMessageWithProofAndWithdrawLST()
    LR->>YM: withdrawLST()
    YM->>DB: mintStETH()
    DB-->>U: send stETH
    Note over YM: Pauses beacon deposits,<br/>creates interest-bearing liability
```

This creates an LST liability that accrues interest; the system prioritizes repaying it from subsequent fund flows and yield.

### 6. Ossification withdrawal

Ossification permanently freezes the StakingVault implementation, opting out of future upgrades. The Security Council initiates it; the Automation Service then progressively withdraws all staked funds back to LineaRollup.

```mermaid
sequenceDiagram
    actor SC as Security Council
    actor Auto as Automation Service
    participant YM as YieldManager
    participant DB as Dashboard
    participant SV as StakingVault
    participant LR as LineaRollup

    SC->>YM: initiateOssification()
    YM-->>DB: voluntaryDisconnect()
    Note over DB: Pending disconnection

    Auto->>YM: progressPendingOssification()
    YM-->>SV: ossify()
    Note over SV: Vault ossified

    loop Until all funds withdrawn
        Auto->>YM: unstake()
        Note over SV: Beacon chain withdrawal
        Auto->>YM: safeAddToWithdrawalReserve()
        YM-->>SV: withdraw()
        SV-->>LR: send ETH
    end
```

## Quick reference

| Fund Movement | Source | Destination | Trigger | Role Required |
|--------------|--------|-------------|---------|---------------|
| Stake excess reserve | LineaRollup | StakingVault | Automation | `YIELD_PROVIDER_STAKING_ROLE` |
| Beacon chain deposit | StakingVault | Validators | Node Operator decision | Node Operator |
| Report yield to L2 | synthetic MessageSent event | L2YieldDistributor | Automation | `YIELD_REPORTER_ROLE` |
| Operator replenish reserve | StakingVault | LineaRollup | Reserve below target | `YIELD_PROVIDER_UNSTAKER_ROLE` |
| Permissionless unstake | Validators | StakingVault | Reserve below minimum | Permissionless |
| Permissionless replenish reserve | StakingVault | LineaRollup | Reserve below minimum | Permissionless |
| LST withdrawal | Lido Protocol (minted against StakingVault collateral) | User | Insufficient ETH | Permissionless (user) |
| Ossification withdrawal | StakingVault | LineaRollup | Security Council initiates | `OSSIFICATION_INITIATOR_ROLE` + `OSSIFICATION_PROCESSOR_ROLE` |
| Donation | External | LineaRollup / StakingVault | Voluntary | Permissionless |
