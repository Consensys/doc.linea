---
title: Transaction lifecycle
description: >-
  An overview of what happens to transactions executed on Linea from submission to finalization
image: /img/socialCards/transaction-lifecycle.jpg
---

Transactions on Linea proceed through the following steps:

## Step 1: Submission

A user signs a transaction and broadcasts it to Linea. These transactions enter 
the mempool as pending.

- **Components:** RPC nodes, full nodes (composed of the execution layer 
[Besu](../get-started/how-to/run-a-node/linea-besu.mdx) or [Geth](../get-started/how-to/run-a-node/geth.mdx), 
and the consensus layer [Maru](../get-started/how-to/run-a-node/maru.mdx))
- **Finality:** None (pending)

## Step 2: Block building

The Linea [sequencer](./sequencer/index.mdx) is responsible for ordering, building, and 
executing blocks. 

The sequencer checks the validity of each transaction added to the mempool, rejecting transactions 
as necessary. 

The sequencer orders transactions, taking into account the [priority fee paid](./gas.mdx#variable-cost-and-linea_estimategas). Valid transactions are placed into blocks in the correct sequence 
and executed.

:::note[Validity]

While the Linea chain may be followed using any Ethereum-compatible client, transaction validity conditions are specific to Linea, and differ slightly from those of other networks, including Ethereum.

:::

At this point, the execution layer's state changes and the block containing the transaction is 
added to the "head" of the Linea blockchain—the most recent block—and a transaction receipt is 
returned to the user's wallet as confirmation.

- **Components:** [Besu](../get-started/how-to/run-a-node/linea-besu.mdx) with sequencer plugins
- **Finality:** None (executing)

## Step 3: State tracking

Data about the transaction and the state of the network at its time of execution are recorded
in **traces**, an output of part of the sequencer called the [trace generator](./sequencer/traces-generator.mdx).

Traces are passed to the state manager block-by-block and then used to record and track state changes 
for batching and proof generation. With the transaction executed and state updated, the transaction 
has reached **soft finality** and the user sees the transaction reflected and confirmed in their wallet.

From Linea's perspective, the transaction is complete, however, an [L2 like Linea](./architecture.mdx) 
must still reach hard finality on the L1.

- **Components:** [Besu](../get-started/how-to/run-a-node/linea-besu.mdx) with tracer plugins
- **Finality:** Soft finality (Linea)

## Step 4: Conflation

The transaction's block undergoes [conflation](./sequencer/conflation.mdx): multiple consecutive 
blocks are merged into a single batch that forms part of the package of data posted to Ethereum. 

Combining transaction data lets the system generate one proof for many transactions, 
reducing the cost of submitting proofs to the finalization layer.

Occasionally, a batch may only consist of one block, with no conflation having taken place.
This occurs when chain activity levels are particularly high, and the block size is larger
than normal.

- **Components:** [Coordinator](./coordinator.mdx)
- **Finality:** Soft finality (Linea)

## Step 5: Proof generation

Next, Linea generates a zk-proof using the transaction data. When prompted by the [coordinator](./coordinator.mdx), 
Linea's [prover](./prover/trace-expansion.mdx) **expands** the trace, preparing it for inclusion in 
the proof. The final zk-SNARK attests to the conflated batch (multiple blocks), enabling a single 
proof to verify many transactions.

Linea's prover employs a two-stage method for developing the proofs, providing an inner and outer proof. The [inner proof](https://paragraph.com/%40linea/the-linea-prover-for-a-very-smart-high-schooler)
 uses a combination of tools, including Arcane and Vortex, to recursively reduce the proof size. The outer proof is generated using the Consensys-maintained library 
[`gnark`](https://docs.gnark.consensys.net/), compressing the proof size even further. The resulting 
proof is the zk-SNARK: the proof that's submitted to Ethereum.

- **Components:** [Prover](./prover/index.mdx), [tracer](./sequencer/traces-generator.mdx), [Shomei state manager](./repos.mdx#shomei)
- **Finality:** Soft finality (Linea)

## Step 6: Batch finalization

The proof for the batch is submitted to Ethereum Mainnet. This proof attests to the execution of all transactions in the batch, including our user's transaction introduced in [step 1](#step-1-submission). 

Two elements are submitted to the L1:

- Blob data: which contains L2 transaction and messaging data
- The proof: as [detailed in step 5](#step-5-proof-generation)

The blob data shared with the L1 can be used to reconstruct Linea's state and verify the data underlying the 
proof--before it disappears from the L1, after 4,096 epochs (~18 days). The Linea rollup contract on L1 calls the 
Ethereum verifier contract which uses the blob data to determine whether or not to accept the batch as valid.

:::note[Calldata]

Up until Linea Alpha v3, L2 transaction data was transported to L1 via `calldata` embedded in
transactions. Although effective, this method was costly, and has now been replaced by
blob-carrying transactions made possible by EIP-4844, added in Ethereum's Dencun upgrade.

:::

You can view finalized batches on [Lineascan](https://lineascan.build/batches).

Once the proof is verified by the L1 and two epochs have passed, the transaction becomes immutable history,
and reaches **hard finality**. Its lifecycle is complete.

- **Components:** Coordinator, Ethereum finalization contract
- **Finality:** Hard finality (Ethereum)

:::tip[Finality]

Finality has two definitions on Linea:
- Soft finality: The [transaction is confirmed on Linea](#step-3-state-tracking). This takes two seconds (Linea's block time). For simplicity, Linea is guaranteed to not reorg—remove competing versions of blockchain history in favor of a canonical one—when there are reorgs on L1. 
- Hard finality: The proof submitted to L1 has been verified and two epochs have elapsed. The 
typical time before [hard finality](#step-6-batch-finalization) is 6-32 hours, although the six-hour minimum will be reduced to zero in future.

:::

## Next steps

For the source code underpinning the Linea tech stack described here, see the [Linea repositories](/technology/repos).